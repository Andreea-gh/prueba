clc;
clear all
close all

[entrada, FS] = audioread('archivoPrueba_CI.wav'); 
x = entrada(:,1);

figure,;
plot(x, 'Color','#7E2F8E');
title('Señal audio');
xlabel('t');
ylabel('Amplitud');

%[X, W] = freqz(x,1);
X = fftshift(fft(x));
F = -FS/2:FS/length(x):FS/2-FS/length(x);

figure,;
%plot(W*FS/(2*pi),abs(X))
plot(F,abs(X), 'Color',	'#CC99FF');
title('Señal sin filtrar');
xlabel('F');
ylabel('Amplitud');

a1 = 1
b1 = [0.00606500466641754	-0.0237025872846861	-0.00518859705901627	-0.000922929275643978	-0.000215692371862228	-0.000374252007419041	-0.000647232647009839	-0.000774884951310224	-0.000674534563746016	-0.000358859054119027	8.23385923833944e-05...
    0.000515919031250960	0.000803744443471994	0.000846992990285306	0.000617632889387285	0.000174244835393275	-0.000353809807569148	-0.000800992115017028	-0.00101627594068142	-0.000913204031287519	-0.000504258776541522	9.98828792858838e-05...
    0.000714611370175701	0.00113944482014371	0.00122022803351179	0.000905885336556150	0.000270799849979668	-0.000497923235595299	-0.00115747259071606	-0.00148249916478638	-0.00134323179819970	-0.000753023119635177	0.000122534917320927...
    0.00101479683853893	0.00163105168093237	0.00175192959109305	0.00130639446908736	0.000408748094376932	-0.000673697521806873	-0.00159627643479083	-0.00204875226266048	-0.00185695031671231	-0.00105231436535197	0.000133780586551283	0.00133160615124801...
    0.00215178294143588	0.00230897732040439	0.00172583146662002	0.000561104176552880	-0.000828198563152340	-0.00200049760886685	-0.00256633403420328	-0.00232496284588401	-0.00132695053401072	0.000125011103203378	0.00157581982389547	0.00255556342456506...
    0.00273928278634472	0.00204757944692105	0.000689939490830447	-0.000911722505548530	-0.00224330355634221	-0.00287871267560403	-0.00259761737258386	-0.00149823041790836	0.000101729402032042	0.00164841201027718	0.00270510507897544	0.00287500415067908...
    0.00214701569508159	0.000754839264289559	-0.000886491975796700	-0.00221112787883953	-0.00281701073325035	-0.00253886329036745	-0.00146669735183625	5.20493860081798e-05	0.00150685593912833	0.00243685346653592	0.00257668378102613	0.00191526750488997...
    0.000682691660939924	-0.000709685014293102	-0.00180889034068258	-0.00227737232082977	-0.00200874477280299	-0.00114039625759330	7.61798423662786e-06	0.00105577969072033	0.00168413477920040	0.00173385833185051	0.00124641287299801	0.000438297969628374...
    -0.000391639180828397	-0.000970333310336606	-0.00114777994601057	-0.000934586012838599	-0.000482121902210620	-3.72403514953946e-06	0.000314912725328339	0.000391837472224136	0.000268217248496851	7.89495741890518e-05	-2.20077413870501e-05	6.21340614959154e-05...
    0.000312795851079300	0.000599202597189454	0.000732436601240682	0.000556948698696626	3.15161840424872e-05	-0.000720268976639704	-0.00143532145699929	-0.00179843939107977	-0.00157007682834042	-0.000696906298366775	0.000625793385342130	0.00199083385644684...
    0.00289942760089431	0.00294166218284970	0.00195754223959547	0.000140792511951394	-0.00198726446731412	-0.00372225823324959	-0.00440887118053225	-0.00367560885089335	-0.00160909573558836	0.00123508386048028	0.00396794904979227	0.00565049111878771	0.00560130445288205...
    0.00368040587170298	0.000348364851663912	-0.00338662901127150	-0.00631943580185407	-0.00739696940820068	-0.00610795228573871	-0.00270909975693828	0.00184363235251291	0.00611134482356886	0.00866404754123572	0.00854606316822143	0.00561307438066034	0.000655321532736611...
    -0.00481739934534716	-0.00904158429488356	-0.0105586557685422	-0.00871305611625743	-0.00392705719265705	0.00238717020159889	0.00824784369562034	0.0117198491552870	0.0115515689293943	0.00762529892710169	0.00105075014745595	-0.00615165477886312	-0.0116713742106511...
    -0.0136449594779921	-0.0112853316100743	-0.00518677575864035	0.00281541938567201	0.0101997117176706	0.0145569927971248	0.0143750494621168	0.00955861234334184	0.00150966832589489	-0.00727555576750960	-0.0139845025972218	-0.0163938668555510	-0.0136073588556197	-0.00637998736600685...
    0.00308162067843521	0.0117933626668852	0.0169367413392336	0.0167748147500673	0.0112393282524675	0.00198981519344952	-0.00808576820042617	-0.0157739176342979	-0.0185649816691612	-0.0154773735000834	-0.00739937257770278	0.00316885607189715	0.0128879552261415	0.0186384032041287...
    0.0185273628548624	0.0125149129203838	0.00244656127919858	-0.00851311237097904	-0.0168768284185936	-0.0199524570035999	-0.0167147574832140	-0.00814056041920395	0.00307917439972291	0.0133907802277345	0.0195086538183284	0.0194702850854939	0.0132551967353490	0.00282334324842181...
    -0.00852764143028552	-0.0171980335027810	0.979573132349412	-0.0171980335027810	-0.00852764143028552	0.00282334324842181	0.0132551967353490	0.0194702850854939	0.0195086538183284	0.0133907802277345	0.00307917439972291	-0.00814056041920395	-0.0167147574832140	-0.0199524570035999...
    -0.0168768284185936	-0.00851311237097904	0.00244656127919858	0.0125149129203838	0.0185273628548624	0.0186384032041287	0.0128879552261415	0.00316885607189715	-0.00739937257770278	-0.0154773735000834	-0.0185649816691612	-0.0157739176342979	-0.00808576820042617	0.00198981519344952...
    0.0112393282524675	0.0167748147500673	0.0169367413392336	0.0117933626668852	0.00308162067843521	-0.00637998736600685	-0.0136073588556197	-0.0163938668555510	-0.0139845025972218	-0.00727555576750960	0.00150966832589489	0.00955861234334184	0.0143750494621168	0.0145569927971248...
    0.0101997117176706	0.00281541938567201	-0.00518677575864035	-0.0112853316100743	-0.0136449594779921	-0.0116713742106511	-0.00615165477886312	0.00105075014745595	0.00762529892710169	0.0115515689293943	0.0117198491552870	0.00824784369562034	0.00238717020159889	-0.00392705719265705...
    -0.00871305611625743	-0.0105586557685422	-0.00904158429488356	-0.00481739934534716	0.000655321532736611	0.00561307438066034	0.00854606316822143	0.00866404754123572	0.00611134482356886	0.00184363235251291	-0.00270909975693828	-0.00610795228573871	-0.00739696940820068...
    -0.00631943580185407	-0.00338662901127150	0.000348364851663912	0.00368040587170298	0.00560130445288205	0.00565049111878771	0.00396794904979227	0.00123508386048028	-0.00160909573558836	-0.00367560885089335	-0.00440887118053225	-0.00372225823324959	-0.00198726446731412...
    0.000140792511951394	0.00195754223959547	0.00294166218284970	0.00289942760089431	0.00199083385644684	0.000625793385342130	-0.000696906298366775	-0.00157007682834042	-0.00179843939107977	-0.00143532145699929	-0.000720268976639704	3.15161840424872e-05	0.000556948698696626...
    0.000732436601240682	0.000599202597189454	0.000312795851079300	6.21340614959154e-05	-2.20077413870501e-05	7.89495741890518e-05	0.000268217248496851	0.000391837472224136	0.000314912725328339	-3.72403514953946e-06	-0.000482121902210620	-0.000934586012838599	-0.00114777994601057...
    -0.000970333310336606	-0.000391639180828397	0.000438297969628374	0.00124641287299801	0.00173385833185051	0.00168413477920040	0.00105577969072033	7.61798423662786e-06	-0.00114039625759330	-0.00200874477280299	-0.00227737232082977	-0.00180889034068258	-0.000709685014293102	0.000682691660939924...
    0.00191526750488997	0.00257668378102613	0.00243685346653592	0.00150685593912833	5.20493860081798e-05	-0.00146669735183625	-0.00253886329036745	-0.00281701073325035	-0.00221112787883953	-0.000886491975796700	0.000754839264289559	0.00214701569508159	0.00287500415067908	0.00270510507897544...
    0.00164841201027718	0.000101729402032042	-0.00149823041790836	-0.00259761737258386	-0.00287871267560403	-0.00224330355634221	-0.000911722505548530	0.000689939490830447	0.00204757944692105	0.00273928278634472	0.00255556342456506	0.00157581982389547	0.000125011103203378	-0.00132695053401072...
    -0.00232496284588401	-0.00256633403420328	-0.00200049760886685	-0.000828198563152340	0.000561104176552880	0.00172583146662002	0.00230897732040439	0.00215178294143588	0.00133160615124801	0.000133780586551283	-0.00105231436535197	-0.00185695031671231	-0.00204875226266048	-0.00159627643479083...
    -0.000673697521806873	0.000408748094376932	0.00130639446908736	0.00175192959109305	0.00163105168093237	0.00101479683853893	0.000122534917320927	-0.000753023119635177	-0.00134323179819970	-0.00148249916478638	-0.00115747259071606	-0.000497923235595299	0.000270799849979668	0.000905885336556150...
    0.00122022803351179	0.00113944482014371	0.000714611370175701	9.98828792858838e-05	-0.000504258776541522	-0.000913204031287519	-0.00101627594068142	-0.000800992115017028	-0.000353809807569148	0.000174244835393275	0.000617632889387285	0.000846992990285306	0.000803744443471994	0.000515919031250960...
    8.23385923833944e-05	-0.000358859054119027	-0.000674534563746016	-0.000774884951310224	-0.000647232647009839	-0.000374252007419041	-0.000215692371862228	-0.000922929275643978	-0.00518859705901627	-0.0237025872846861	0.00606500466641754];

a2 = 1;
b2 =[-0.0182269552082438	0.0120073506431668	0.00833622174970452	0.00570312471319906	0.00398878756485987	0.00302422861970036	0.00256712565066436	0.00234208699411560	0.00209650343744359	0.00167531213840301	0.00105551496720995	0.000348631353146516	-0.000258344945609239...
    -0.000578884522553793	-0.000518795983543629	-0.000119871878648583	0.000438310800843125	0.000907358765209630	0.00106288282993732	0.000806353000501660	0.000207432456292651	-0.000506232062909743	-0.00104199070691852	-0.00115815665514667...
    -0.000777625365237436	-2.85123313941127e-05	0.000790126119824449	0.00133156045507680	0.00133862886894939	0.000772922230023426	-0.000165183349344422	-0.00109320961010165	-0.00161459080357236	-0.00147456965210940	-0.000694965919216930	0.000433886939205275...
    0.00144260278642000	0.00189635445618870	0.00156219255408143	0.000545803602797484	-0.000762293976260969	-0.00180870407960011	-0.00214281657231623	-0.00157374730704668	-0.000318639753760439	0.00114271907418193	0.00216074846359517	0.00233231421568713	0.00149796304559698...
    4.30925887032494e-06	-0.00152465969167033	-0.00249241090500664	-0.00242503374591368	-0.00132741518825501	0.000358017023360210	0.00192450452816870	0.00272868680426206	0.00240792960978656	0.00107198791756951	-0.000746229500204579	-0.00228033965708672	-0.00288172873483816...
    -0.00228065137867351	-0.000724961413778169	0.00114417893072162	0.00254405289619538	0.00289342739725872	0.00204137025350423	0.000346322840647647	-0.00148876810869874	-0.00269533670140837	-0.00277806781574589	-0.00171029719739419	4.75620929212610e-05	0.00175595246545434	0.00270539206465984...
    0.00251995840523951	0.00130403930330753	-0.000407941935891855	-0.00189334797256005	-0.00254646331446337	-0.00213356444550936	-0.000872381134751426	0.000675706181545201	0.00185957003510731	0.00221468726678528	0.00165103802740910	0.000466777400196626	-0.000804199153961113	-0.00163363583679523...
    -0.00172615480508043	-0.00111987561147409	-0.000147869136796727	0.000745034531870428	0.00120245714390745	0.00109924886904570	0.000592420189702588	-3.68984373336211e-05	-0.000470119442938349	-0.000570265167118452	-0.000391634477452769	-0.000128140659800684	1.84783468025992e-05...
    -5.00929062535896e-05	-0.000242173637724950	-0.000355772970334841	-0.000203982509009483	0.000241637008808427	0.000813176621779585	0.00118750999482488	0.00106224785278114	0.000333195050589918	-0.000784826561817734	-0.00181702839743789	-0.00221875570653141	-0.00165698818961799	-0.000203735730007450...
    0.00161506692098699	0.00300838208184727	0.00325409922430005	0.00206008992838672	-0.000237312707640590	-0.00274156483544054	-0.00434575605761321	-0.00421288598404481	-0.00219837865263004	0.00101417834617609	0.00412451360470208	0.00574514748306207	0.00500791402431311	0.00201207215966490	-0.00213694610903217	-0.00571987005014943...
    -0.00712245797655807	-0.00554886191371532	-0.00144788085012698	0.00359504490312699	0.00745795102570499	0.00838397559667991	0.00576278794632236	0.000491215932638023	-0.00533852710452256	-0.00924134103288522	-0.00942718529398012	-0.00558481280015027	0.000866695760605115	0.00730805682107183	0.0109811165522821	0.0101659251568266...
    0.00497487690015231	-0.00258920789702627	-0.00941646480410133	-0.0125616476038508	-0.0105157111422249	-0.00391549133296572	0.00462414894937685	0.0115565197153184	0.0138727638933281	0.0104085531644366	0.00240989029293856	-0.00689842290398869	-0.0136224292608433	-0.0148250571351973	-0.00981371877410039	-0.000504644659201200	0.00930685524624831...
    0.0154936940731190	0.0153370868961807	0.00872377397036369	-0.00173746590939374	-0.0117388779004973	-0.0170610990746829	-0.0153476406800061	-0.00715554625738369	0.00422186020640645	0.0140717580376433	0.0182280998539447	0.0148293972247880	0.00516022378059085	-0.00684097447912231	-0.0161813994343991	-0.0189074505743782	-0.0137721661687940	-0.00281174278365837...
    0.00947327765005079	0.0179585640645711	0.0190538014671178	0.0122122898575906	0.000211910977836233	-0.0119921070960053	-0.0193068809942737	-0.0186412072206253	-0.0102138701536570	0.00251550796318651	0.0142682394536053	0.0201441994265594	0.0176755297215148	0.00785741701560552	-0.00524599841839574	-0.0161913429166105	0.979573733320026	-0.0161913429166105	-0.00524599841839574...
    0.00785741701560552	0.0176755297215148	0.0201441994265594	0.0142682394536053	0.00251550796318651	-0.0102138701536570	-0.0186412072206253	-0.0193068809942737	-0.0119921070960053	0.000211910977836233	0.0122122898575906	0.0190538014671178	0.0179585640645711	0.00947327765005079	-0.00281174278365837	-0.0137721661687940	-0.0189074505743782	-0.0161813994343991	-0.00684097447912231...
    0.00516022378059085	0.0148293972247880	0.0182280998539447	0.0140717580376433	0.00422186020640645	-0.00715554625738369	-0.0153476406800061	-0.0170610990746829	-0.0117388779004973	-0.00173746590939374	0.00872377397036369	0.0153370868961807	0.0154936940731190	0.00930685524624831	-0.000504644659201200	-0.00981371877410039	-0.0148250571351973	-0.0136224292608433	-0.00689842290398869...
    0.00240989029293856	0.0104085531644366	0.0138727638933281	0.0115565197153184	0.00462414894937685	-0.00391549133296572	-0.0105157111422249	-0.0125616476038508	-0.00941646480410133	-0.00258920789702627	0.00497487690015231	0.0101659251568266	0.0109811165522821	0.00730805682107183	0.000866695760605115	-0.00558481280015027	-0.00942718529398012	-0.00924134103288522	-0.00533852710452256...
    0.000491215932638023	0.00576278794632236	0.00838397559667991	0.00745795102570499	0.00359504490312699	-0.00144788085012698	-0.00554886191371532	-0.00712245797655807	-0.00571987005014943	-0.00213694610903217	0.00201207215966490	0.00500791402431311	0.00574514748306207	0.00412451360470208	0.00101417834617609	-0.00219837865263004	-0.00421288598404481	-0.00434575605761321	-0.00274156483544054...
    -0.000237312707640590	0.00206008992838672	0.00325409922430005	0.00300838208184727	0.00161506692098699	-0.000203735730007450	-0.00165698818961799	-0.00221875570653141	-0.00181702839743789	-0.000784826561817734	0.000333195050589918	0.00106224785278114	0.00118750999482488	0.000813176621779585	0.000241637008808427	-0.000203982509009483	-0.000355772970334841	-0.000242173637724950	-5.00929062535896e-05...
    1.84783468025992e-05	-0.000128140659800684	-0.000391634477452769	-0.000570265167118452	-0.000470119442938349	-3.68984373336211e-05	0.000592420189702588	0.00109924886904570	0.00120245714390745	0.000745034531870428	-0.000147869136796727	-0.00111987561147409	-0.00172615480508043	-0.00163363583679523	-0.000804199153961113	0.000466777400196626	0.00165103802740910	0.00221468726678528	0.00185957003510731...
    0.000675706181545201	-0.000872381134751426	-0.00213356444550936	-0.00254646331446337	-0.00189334797256005	-0.000407941935891855	0.00130403930330753	0.00251995840523951	0.00270539206465984	0.00175595246545434	4.75620929212610e-05	-0.00171029719739419	-0.00277806781574589	-0.00269533670140837	-0.00148876810869874	0.000346322840647647	0.00204137025350423	0.00289342739725872	0.00254405289619538	0.00114417893072162...
    -0.000724961413778169	-0.00228065137867351	-0.00288172873483816	-0.00228033965708672	-0.000746229500204579	0.00107198791756951	0.00240792960978656	0.00272868680426206	0.00192450452816870	0.000358017023360210	-0.00132741518825501	-0.00242503374591368	-0.00249241090500664	-0.00152465969167033	4.30925887032494e-06	0.00149796304559698	0.00233231421568713	0.00216074846359517	0.00114271907418193	-0.000318639753760439...
    -0.00157374730704668	-0.00214281657231623	-0.00180870407960011	-0.000762293976260969	0.000545803602797484	0.00156219255408143	0.00189635445618870	0.00144260278642000	0.000433886939205275	-0.000694965919216930	-0.00147456965210940	-0.00161459080357236	-0.00109320961010165	-0.000165183349344422	0.000772922230023426	0.00133862886894939	0.00133156045507680	0.000790126119824449	-2.85123313941127e-05	-0.000777625365237436...
    -0.00115815665514667	-0.00104199070691852	-0.000506232062909743	0.000207432456292651	0.000806353000501660	0.00106288282993732	0.000907358765209630	0.000438310800843125	-0.000119871878648583	-0.000518795983543629	-0.000578884522553793	-0.000258344945609239	0.000348631353146516	0.00105551496720995	0.00167531213840301	0.00209650343744359	0.00234208699411560	0.00256712565066436	0.00302422861970036	0.00398878756485987...
    0.00570312471319906	0.00833622174970452	0.0120073506431668	-0.0182269552082438];

%Filtrado FIR
y1 = filter(b1,a1,x);
y2 = filter(b2,a2,y1);

figure,;
plot(y1, 'Color',	'#F94C66');
title('Señal audio con primer filtro');
xlabel('t');
ylabel('Amplitud');

Y1 = fftshift(fft(y1));
F1=-FS/2:FS/length(Y1):FS/2-FS/length(Y1);
figure,;
plot(F1,abs(Y1), 'Color',	'#FCA6B2');
title('Señal con primer filtro ');
xlabel('F');
ylabel('Amplitud');

figure,;
plot(y2, 'Color',	'#53BF9D');
title('Señal audio con segundo filtro');
xlabel('t');
ylabel('Amplitud');

Y2 = fftshift(fft(y2));
F2=-FS/2:FS/length(Y2):FS/2-FS/length(Y2);
figure,;
plot(F2,abs(Y2), 'Color',	'#B0E2D3');
title('Señal con segundo filtro ');
xlabel('F');
ylabel('Amplitud');

%sound(y2,FS);

audiowrite('GutiérrezHerreraAndrea_FiltradaFIR.wav',y2,FS);